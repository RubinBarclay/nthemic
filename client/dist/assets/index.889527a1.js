var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,c=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&n(e,a,t[a]);if(r)for(var a of r(t))s.call(t,a)&&n(e,a,t[a]);return e},o=(e,r)=>t(e,a(r));import{r as i,B as m,R as u,t as p,c as d,P as y,u as x,C as b,N as h,H as f,S as g,a as E,b as v,L as w,d as N,e as k,F as S,V as C,f as I,g as T,h as P,i as L,j as D}from"./vendor.55193334.js";const M=()=>{const[e,t]=i.exports.useState(""),[a,r]=i.exports.useState(!0);return i.exports.useEffect((()=>{m.getParser(window.navigator.userAgent).satisfies({desktop:{chrome:">60",edge:">79"}})||(r(!1),t(u.createElement("p",{className:"w-4/5 py-10 text-lg xl:w-1/4 lg:w-1/3 sm:w-1/2"},"The Spotify Web Playback SDK currently does not support your browser. Please try using the desktop version of Google Chrome or Microsoft Edge."))),new RegExp("error").test(window.location.href)&&t(u.createElement("p",{className:"w-4/5 py-10 text-lg xl:w-1/4 lg:w-1/3 sm:w-1/2"},"An error occured during the authentication process. You must have Spotify Premium in order to use this app, or it could be a temporary problem with Spotify's servers."))}),[]),u.createElement("div",{className:"flex flex-col items-center justify-center h-screen font-sans text-center text-gray-200 bg-gray-900"},e,a?u.createElement("a",{href:"https://accounts.spotify.com/authorize?client_id=11c9d0da629948fb87a800307b571162&response_type=code&redirect_uri=https://nthemic.herokuapp.com/&scope=streaming%20user-read-email%20user-read-private%20user-top-read%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state",className:"px-8 py-4 text-xl bg-purple-500 border-none rounded-full"},"Login with Spotify"):null)},O=i.exports.createContext(),_=({playlist:e,play:t})=>u.createElement("div",{className:"relative flex items-center overflow-hidden h-1/2"},u.createElement("img",{className:"absolute z-0 w-full pointer-events-none filter blur brightness-85",src:e.albumCoverLG,alt:"background image"}),u.createElement("img",{className:"z-10 ml-40 mr-8 bg-red-200 shadow-xl w-72 h-72",src:e.albumCoverLG,alt:"playlist cover"}),u.createElement("div",{className:"z-10 text-white"},u.createElement("h3",{className:"w-2/3 my-2 text-4xl"},e.description.replace(/Cover:.*$/,"")),u.createElement("button",{onClick:()=>t(e),className:"px-6 py-3 my-2 text-xl bg-transparent border-2 border-white rounded-full transform transition duration-150 hover:scale-105",className:"px-6 py-3 text-xl bg-transparent border-2 border-gray-200 rounded-full hover:bg-gray-200 hover:text-gray-800 transition-colors whitespace-nowrap"},"Listen now"))),j=1/60*1e3,R=({title:e,items:t,play:a})=>{const r=i.exports.useRef(),{isDragging:l}=(e=>{const[t,a]=i.exports.useState(),[r,l]=i.exports.useState(),[s,n]=i.exports.useState(!1),[c,o]=i.exports.useState(0),[m,u]=i.exports.useState(0),[d,y]=i.exports.useState(0),[x,b]=i.exports.useState(0),h=e.current,f=i.exports.useCallback(p((e=>{y(e)}),j),[]),g=i.exports.useCallback(p((t=>{u(t),e.current.scrollLeft=e.current.scrollLeft+t*j*c}),j),[h,c]);return i.exports.useEffect((()=>{0!==c&&(m>.1&&!s?g(-.4+m):s?u(x):o(0))}),[m,s,x,c,g]),i.exports.useEffect((()=>{if(e.current){const c=t=>{a(t.screenX),l(e.current.scrollLeft),o(0)},i=a=>{if(a.preventDefault(),a.stopPropagation(),void 0!==t&&void 0!==r){const l=t-a.screenX;e.current.scrollLeft=r+l,Math.abs(l)>1&&(n(!0),o(l/Math.abs(l)),b(Math.abs((d-a.screenX)/j)),f(a.screenX))}},m=()=>{s&&void 0!==t&&(a(void 0),l(void 0),n(!1))};void 0===e.current.ontouchstart&&(e.current.onmousedown=c,e.current.onmousemove=i,e.current.onmouseup=m,e.current.onmouseleave=m)}}),[h,t,s,r,f,d]),{clickStartX:t,scrollStartX:r,isDragging:s,direction:c,momentum:m,lastScrollX:d,speed:x}})(r);return u.createElement("div",{className:"relative w-full p-4 overflow-hidden cursor-pointer"},u.createElement("h4",{className:"py-2 text-2xl"},e),u.createElement("div",{className:"w-full h-full overflow-x-scroll overflow-y-hidden scrollbar-hide",ref:r},u.createElement("div",{className:"inline-flex h-full",role:"list",style:{pointerEvents:l?"none":void 0}},t.map((e=>u.createElement("img",{src:e.albumCoverLG,alt:e.name,onClick:()=>a(e,null==e?void 0:e.index),key:(null==e?void 0:e.id)?e.id:e.collectionID,className:"flex-shrink-0 w-48 h-48 mr-4",role:"listitem"}))))))},A=({play:e})=>{const t=i.exports.useContext(O),[a,r]=i.exports.useState([]),[l,s]=i.exports.useState([]),[n,c]=i.exports.useState(),[o,m]=i.exports.useState([]),p=new d({clientId:"11c9d0da629948fb87a800307b571162"});return i.exports.useEffect((()=>{t&&(p.setAccessToken(t),p.getMyTopTracks({limit:10}).then((e=>{r(e.body.items.map((e=>({id:e.id,uri:e.uri,name:e.name,type:e.type,album:e.album.name,collectionID:e.album.id,artist:e.artists[0].name,index:e.track_number-1,albumCoverLG:e.album.images[1].url,albumCoverSM:e.album.images[2].url,duration:e.duration_ms}))))})).catch((e=>console.log(e))),p.getNewReleases({limit:10}).then((e=>{s(e.body.albums.items.map((e=>({type:e.type,album:e.name,collectionID:e.id,artist:e.artists[0].name,albumCoverLG:e.images[1].url,albumCoverSM:e.images[2].url}))))})).catch((e=>console.log(e))),p.getFeaturedPlaylists({limit:11}).then((e=>{const t=e.body.playlists.items.map((e=>({type:e.type,name:e.name,collectionID:e.id,description:e.description,albumCoverLG:e.images[0].url})));c(t[0]),m(t.slice(1))})).catch((e=>console.log(e))))}),[t]),n?u.createElement("div",{className:"w-full h-full"},u.createElement(_,{playlist:n,play:e}),u.createElement("div",{className:"p-4"},u.createElement(R,{title:"Your Top Tracks",items:a,play:e}),u.createElement(R,{title:"New music",items:l,play:e}),u.createElement(R,{title:"Featured Playlists",items:o,play:e}))):null},G=({setSearch:e})=>u.createElement("div",{className:"flex items-end justify-center h-1/4"},u.createElement("input",{type:"text",placeholder:"Search",onChange:t=>e(t.target.value),className:"w-1/3 px-2 text-2xl bg-transparent border-b-2 border-purple-500 outline-none focus:border-purple-600"})),$=e=>{var t=Math.floor(e/6e4),a=(e%6e4/1e3).toFixed(0);return t+":"+(a<10?"0":"")+a},X=({play:e,track:t})=>{const[a,r]=i.exports.useState(!1);return u.createElement("div",{className:"flex items-center my-2 cursor-pointer",onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),onClick:()=>e(t,null==t?void 0:t.index)},u.createElement("div",{className:"relative"},u.createElement("img",{className:"w-20 h-auto bg-red-500",src:t.albumCoverSM,alt:t.name}),u.createElement("div",{className:`absolute inset-0 flex justify-center bg-black bg-opacity-50 opacity-${a?100:0} transition-opacity`},u.createElement(y,{className:"w-12 h-auto"}))),u.createElement("div",{className:"px-2 mb-2"},u.createElement("p",{className:"text-xl"},t.name),u.createElement("p",{className:"text-lg text-gray-400"},t.artist)),u.createElement("span",{className:"w-16 ml-auto text-lg text-center text-gray-200"},(()=>{switch(t.type){case"track":return $(t.duration);case"album":return t.albumType.charAt(0).toUpperCase()+t.albumType.slice(1);case"playlist":return"";default:throw"Unknown track type!"}})()))},F=({type:e,results:t,play:a})=>u.createElement("div",{className:"flex flex-col items-center p-8 pb-0"},u.createElement("div",{className:"w-3/5"},u.createElement("h2",{className:"text-2xl"},e),t.map((e=>u.createElement(X,{key:e.id,play:a,track:e}))))),U=({play:e})=>{const t=i.exports.useContext(O),[a,r]=i.exports.useState(""),[l,s]=i.exports.useState(null),[n,c]=i.exports.useState(null),[o,m]=i.exports.useState(null),p=new d({clientId:"11c9d0da629948fb87a800307b571162"});return i.exports.useEffect((()=>{if(!a)return s(null),c(null),void m(null);if(!t)return;let e=!1;return p.setAccessToken(t),p.searchTracks(a,{limit:6}).then((t=>{e||s(t.body.tracks.items.map((e=>({id:e.id,uri:e.uri,name:e.name,type:e.type,collectionID:e.album.id,artist:e.artists[0].name,index:e.track_number-1,albumCoverLG:e.album.images[2].url,albumCoverSM:e.album.images[2].url,duration:e.duration_ms}))))})),p.searchAlbums(a,{limit:6}).then((t=>{e||c(t.body.albums.items.map((e=>({id:e.id,uri:e.uri,type:e.type,name:e.name,artist:e.artists[0].name,collectionID:e.id,albumCoverSM:e.images[2].url,albumType:e.album_type}))))})),p.searchPlaylists(a,{limit:6}).then((t=>{e||m(t.body.playlists.items.map((e=>({id:e.id,uri:e.uri,type:e.type,name:e.name,collectionID:e.id,albumCoverSM:e.images[0].url}))))})),()=>e=!0}),[a,t]),u.createElement("div",{className:"w-full h-full"},u.createElement(G,{setSearch:r}),l?u.createElement(F,{type:"Songs",results:l,play:e}):null,n?u.createElement(F,{type:"Albums",results:n,play:e}):null,o?u.createElement(F,{type:"Playlists",results:o,play:e}):null)};const z=()=>u.createElement("div",{className:"flex flex-col items-center justify-center w-full h-full"},u.createElement("img",{src:"/assets/under-construction.def95898.png",alt:"under construction",className:"h-auto w-80 opacity-85 filter invert"}),u.createElement("h2",{className:"m-4 text-5xl"},"Under Construction")),B=({play:e})=>{const{id:t,type:a}=x(),[r,l]=i.exports.useState(),[s,n]=i.exports.useState(!1),c=i.exports.useContext(O),o=new d({clientId:"11c9d0da629948fb87a800307b571162"});return i.exports.useEffect((()=>{c&&(o.setAccessToken(c),"album"===a||"track"===a?o.getAlbum(t).then((e=>{l({type:a,collectionID:t,name:e.body.name,author:e.body.artists[0].name,albumCoverLG:e.body.images[1].url,tracks:e.body.tracks.items.map((r=>({type:a,collectionID:t,id:r.id,uri:r.uri,name:r.name,album:e.body.name,artist:r.artists[0].name,duration:r.duration_ms,albumCoverLG:e.body.images[1].url,albumCoverSM:e.body.images[2].url})))})})):"playlist"===a&&o.getPlaylist(t).then((e=>{l({type:a,collectionID:t,name:e.body.name,author:e.body.owner.display_name,albumCoverLG:e.body.images[0].url,tracks:e.body.tracks.items.slice(0,20).map((e=>({type:a,collectionID:t,id:e.track.id,uri:e.track.uri,name:e.track.name,album:e.track.album.name,artist:e.track.artists[0].name,duration:e.track.duration_ms,albumCoverLG:e.track.album.images[1].url,albumCoverSM:e.track.album.images[2].url})))})})))}),[c]),r?u.createElement("div",{className:"w-full h-full px-48 pt-32"},u.createElement("div",{className:"border-2 border-t-0 border-gray-800"},u.createElement("div",{className:"flex items-center h-auto bg-gray-800"},u.createElement("img",{className:"w-64 h-auto",src:r.albumCoverLG,alt:r.name}),u.createElement("div",{className:"pl-6"},u.createElement("h1",{className:"text-4xl"},r.name),u.createElement("h2",{className:"py-2 text-xl text-gray-400"},"By: ",r.author)),u.createElement("button",{className:"px-6 py-3 ml-auto mr-16 text-xl bg-transparent border-2 border-gray-200 rounded-full hover:bg-gray-200 hover:text-gray-900 transition-colors whitespace-nowrap",onClick:()=>e(r)},"Play now")),u.createElement("table",{className:"w-full mt-5 text-lg text-center"},u.createElement("thead",null,u.createElement("tr",null,u.createElement("th",{className:"w-8"},"#"),u.createElement("th",{className:"pl-2 text-left"},"Track"),u.createElement("th",{className:"w-16"},u.createElement(b,{className:"w-5 h-auto mx-auto"})))),u.createElement("tbody",null,r.tracks.map(((t,a)=>u.createElement("tr",{key:t.id,onClick:()=>e(t,a),onMouseOver:()=>n(a),onMouseOut:()=>n(null),className:"h-4 leading-8 hover:bg-gray-800"},u.createElement("td",null,s===a?u.createElement(y,{className:"w-5 h-auto mx-auto"}):a+1),u.createElement("td",{className:"pl-2 text-left"},t.name),u.createElement("td",null,$(t.duration)))))))),u.createElement("div",{className:"p-8"})):null},W=()=>u.createElement("div",{className:"py-2 bg-gray-800 col-span-2"},u.createElement("h1",{className:"p-6 text-3xl font-semibold text-center text-purple-500"},u.createElement("span",{className:"text-4xl text-purple-400"},"N"),"themic"),u.createElement("div",{className:"flex flex-col"},u.createElement(h,{exact:!0,to:"/",activeClassName:"bg-gray-700",className:"flex items-center p-4 px-8 text-xl transition-colors hover:text-purple-400"},u.createElement(f,{className:"w-6 h-6"}),u.createElement("span",{className:"pl-4"},"Home")),u.createElement(h,{to:"/search",activeClassName:"bg-gray-700",className:"flex items-center p-4 px-8 text-xl transition-colors hover:text-purple-400"},u.createElement(g,{className:"w-6 h-6"}),u.createElement("span",{className:"pl-4"},"Search")),u.createElement(h,{to:"/settings",activeClassName:"bg-gray-700",className:"flex items-center p-4 px-8 text-xl transition-colors hover:text-purple-400"},u.createElement(E,{className:"w-6 h-6"}),u.createElement("span",{className:"pl-4"},"Settings")))),J=({track:e,playing:t,progressState:a,setProgressState:r,nextTrack:l,player:s})=>{const[n,c]=i.exports.useState(!1);let o=i.exports.useRef("0%"),m=i.exports.useRef(new v(0)),p=i.exports.useRef(0);i.exports.useEffect((()=>{c(!0),r(o);const e=setInterval(d,500);return t?()=>clearInterval(e):clearInterval(e)}),[t]),i.exports.useEffect((()=>{o.current="0%",m.current=new v(0),p.current=e.duration,c(!1),r("0%")}),[e]);const d=()=>{!n&&c(!0);const e=m.current.plus(500).div(p.current).times(100).toString()+"%";m.current=m.current.plus(500),o.current=e,r(e),y()},y=()=>{m.current.gte(p.current)&&l()};return u.createElement("div",{className:"absolute top-0 left-0 right-0 flex bg-gray-700"},u.createElement("input",{type:"range",id:"progressSelector",min:"0",max:"200",className:"absolute inset-0 w-full opacity-0 cursor-pointer",onClick:e=>(e=>{const t=new v(e).div(2).toFixed(1),a=new v(p.current).times(new v(t).div(100));o.current=t+"%",m.current=a,c(!1),r(t+"%"),s.seek(a.toNumber()),y()})(e.target.value)}),u.createElement("div",{className:"bg-purple-500",style:{height:"0.2rem",width:a,transition:n?"all .5s linear":null}}))},K=({currentItem:{item:e,index:t}})=>{const a=i.exports.useContext(O),[r,l]=i.exports.useState(!1),[s,n]=i.exports.useState(),[m,p]=i.exports.useState([]),[x,b]=i.exports.useState(),[h,f]=i.exports.useState("0%"),[g,E]=i.exports.useState(25),[v,T]=i.exports.useState(!1),[P,L]=i.exports.useState(!1);let D=i.exports.useRef(),M=i.exports.useRef(0);const _=new d({clientId:"11c9d0da629948fb87a800307b571162"});i.exports.useEffect((()=>{if(a&&window.Spotify)return D.current=new window.Spotify.Player({name:"Nthemic Music Player",getOAuthToken:e=>{e(a)},volume:.25}),D.current.connect().then((e=>{e?console.log("The Web Playback SDK successfully connected to Spotify!"):console.log("[ERROR] The Web Playback SDK failed to connect to Spotify")})),D.current.addListener("ready",(({device_id:e})=>{b(e)})),()=>D.current.disconnect()}),[a]),i.exports.useEffect((()=>{if(e&&a)switch(_.setAccessToken(a),e.type){case"track":case"album":_.getAlbumTracks(e.collectionID,{limit:20}).then((a=>{const r=t=>o(c({},e),{id:t.id,uri:t.uri,name:t.name,duration:t.duration_ms});n(r(a.body.items[t])),p(a.body.items.map(r))})).catch((e=>console.log(e)));break;case"playlist":_.getPlaylistTracks(e.collectionID,{limit:20}).then((a=>{const r=t=>o(c({},e),{id:t.track.id,uri:t.track.uri,name:t.track.name,album:t.track.album.name,artist:t.track.artists[0].name,duration:t.track.duration_ms,albumCoverLG:t.track.album.images[1].url,albumCoverSM:t.track.album.images[2].url});n(r(a.body.items[t])),p(a.body.items.map(r))})).catch((e=>console.log(e)));break;default:console.log("[ERROR] Unknown item type"),console.log("item.type: ",e.type)}}),[e]),i.exports.useEffect((()=>{s&&D.current&&(M.current=t,j({spotify_uri:s.uri,playerInstance:D.current}),L(!0))}),[m]);const j=({spotify_uri:e,playerInstance:{_options:{getOAuthToken:t}}})=>{l(!0),t((t=>{fetch(`https://api.spotify.com/v1/me/player/play?device_id=${x}`,{method:"PUT",body:JSON.stringify({uris:[e]}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}})}))},R=()=>{const e=M.current+1;M.current=M.current+1,e<m.length?(j({spotify_uri:m[e].uri,playerInstance:D.current}),n(m[e])):(D.current.pause(),l(!1),f("100%"))};return P?u.createElement("div",{className:"relative flex items-center justify-center w-screen h-20 bg-gray-900"},u.createElement(J,{track:s,trackList:m,playing:r,setPlaying:l,progressState:h,setProgressState:f,nextTrack:R,player:D.current}),u.createElement(w,{to:`/collection/${s.type}/${s.collectionID}`},u.createElement("img",{className:"w-16 cursor-pointer h-14",src:null==s?void 0:s.albumCoverSM,alt:null==s?void 0:s.name})),u.createElement("div",{className:"px-5 text-center"},u.createElement(w,{className:"hover:underline",to:`/collection/${s.type}/${s.collectionID}`},s.name),u.createElement("p",{className:"text-sm text-gray-400"},s.artist)),u.createElement(N,{className:"w-8 h-8",onClick:()=>{const e=M.current-1;M.current=M.current-1,e>=0?(j({spotify_uri:m[e].uri,playerInstance:D.current}),n(m[e])):(j({spotify_uri:m[0].uri,playerInstance:D.current}),n(m[0]))}}),u.createElement("div",{onClick:()=>{D.current.togglePlay().then((()=>{l((e=>!e))}))}},r?u.createElement(k,{className:"w-10 h-10"}):u.createElement(y,{className:"w-10 h-10"})),u.createElement(S,{className:"w-8 h-8",onClick:R}),u.createElement("div",{className:"relative m-4",onWheel:e=>{E((t=>{let a=e.deltaY<0?t+5:t-5;return a=a>100?100:a<0?0:a,D.current.setVolume(a/100),a}))},onClick:()=>{D.current.setVolume(v?g/100:0),T((e=>!e))}},v?u.createElement(C,{className:"w-6 h-6"}):u.createElement(i.exports.Fragment,null,u.createElement(I,{className:"w-6 h-6"}),u.createElement("span",{className:"absolute text-gray-400 left-full top-1/2 transform translate-x-2 -translate-y-1/2"},g,"%")))):null},V=({code:e})=>{const t=(e=>{const[t,a]=i.exports.useState(),[r,l]=i.exports.useState(),[s,n]=i.exports.useState();return i.exports.useEffect((()=>{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})};fetch("https://nthemic.herokuapp.com/login",t).then((e=>e.json())).then((e=>{a(e.accessToken),l(e.refreshToken),n(e.expiresIn),window.history.pushState({},null,"/")})).catch((()=>{window.location="/error"}))}),[e]),i.exports.useEffect((()=>{if(!r||!s)return;const e=setInterval((()=>{const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:r})};fetch("https://nthemic.herokuapp.com/refresh",e).then((e=>e.json())).then((e=>{a(e.accessToken),n(e.expiresIn)})).catch((()=>{window.location="/expired"}))}),1e3*(s-60));return()=>clearInterval(e)}),[r,s]),t})(e),[a,r]=i.exports.useState({item:null,index:null}),l=(e,t=0)=>{r({item:e,index:t})};return t?u.createElement(T,null,u.createElement(O.Provider,{value:t},u.createElement("div",{className:"h-screen font-sans text-gray-200 bg-gray-900 grid-rows-custom grid grid-cols-10"},u.createElement(W,null),u.createElement("div",{className:"overflow-y-scroll scrollbar-hide col-span-8 grid-cols-12"},u.createElement(P,null,u.createElement(L,{exact:!0,path:"/",render:()=>u.createElement(A,{play:l})}),u.createElement(L,{path:"/search",render:()=>u.createElement(U,{play:l})}),u.createElement(L,{path:"/settings",component:z}),u.createElement(L,{path:"/collection/:type/:id",component:()=>u.createElement(B,{play:l})}))),u.createElement(K,{currentItem:a})))):null},Y=()=>{const[e,t]=i.exports.useState();return i.exports.useEffect((()=>{t(new URLSearchParams(window.location.search).get("code"))}),[]),e?u.createElement(V,{code:e}):u.createElement(M,null)};D.render(u.createElement(u.StrictMode,null,u.createElement(Y,null)),document.getElementById("root"));
